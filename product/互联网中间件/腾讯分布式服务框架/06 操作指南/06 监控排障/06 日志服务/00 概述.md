
## 日志服务简介
日志服务为用户提供一站式日志服务，从日志采集、日志存储到日志内容搜索，帮助用户轻松定位业务问题。用户通过指定部署组的日志配置项来指定日志采集规则，TSF Agent 根据日志配置项采集指定路径下的文件日志，并上传日志到日志存储模块。用户可以通过 TSF 控制台查看部署组实时日志，并根据关键词来检索日志。

同时日志服务还支持日志告警功能，日志告警功能允许您通过配置业务日志中的关键词，设置关键词出现频率的告警，一旦触发告警条件，告警通知人将会收到告警信息。

下图是用户在 TSF 平台上使用日志服务的流程图：
![](https://main.qcloudimg.com/raw/c54ce0621c5034e2862b72705beaf407.png)

以下视频将为您介绍 TSF 的日志服务功能：

<div class="doc-video-mod"><iframe src="https://cloud.tencent.com/edu/learning/quick-play/2038-24399?source=gw.doc.media&withPoster=1&notip=1"></iframe></div>

## 日志服务原理
![](https://main.qcloudimg.com/raw/2b0ee8cbe76456f5a5941bbcbbc7314c.png)

**日志采集**
通过 Agent 来采集日志，无须手动安装。

**日志索引与查询**
- 实时索引：采集的日志数据建立索引。
- 查询灵活：支持全文检索、关键词检索（短语或者分词）。


## 日志存储额度与删除策略说明

- 存储额度：TSF 为用户提供了日志存储的免费额度。免费存储额度与客户使用的版本、节点数相关。
<table>
<thead>
<tr>
<th align="left">版本</th>
<th align="left">基础版</th>
<th align="left">专业版</th>
<th align="left">铂金版</th>
</tr>
</thead>
<tbody><tr>
<td align="left">每个节点免费额度</td>
<td align="left">3GB/节点/月</td>
<td align="left">4GB/节点/月</td>
<td align="left">20GB/节点/月</td>
</tr>
</tbody></table>
- 用户可在 TSF 控制台的概览页查看当前日志使用量与存储额度，该数据每小时刷新一次。TSF 在统计日志使用量时仅会统计标准输出日志与日志配置项日志，不包括 GC 日志与 Mesh Sidecar 日志。当日志达到免费额度上限时，平台将通过短信、邮件、微信等方式向您发送通知。超过上限时，我们将按照如下的删除策略删除日志直到日志总存储量低于免费额度。
- TSF 日志删除策略包括两部分：超量删除与超时删除
  - 超量删除针对用户日志使用量超过了日志额度的场景。超量删除仅针对标准输出日志与日志配置项日志。TSF 每小时会检测用户的日志使用量，如果超出用户日志存储额度，TSF 会依次删除最久的日志直到日志使用量低于存储额度，TSF 将优先删除标准输出日志，删除过程不会影响最新日志的写入和查询。TSF 删除日志的粒度由存储量（一般是 60 G）和创建天数（一般是 30 天）共同决定；
  - 超时删除是指 TSF 会每天检测用户的日志并删除写入超过 30 天的日志。超时删除针对标准输出日志、日志配置项日志、GC 日志和Mesh Sidercar 日志。在用户日志使用量不大或日志存储额度较多的场景下，可能会出现能够查看 30 天之前日志的情况，但 TSF 不保证写入超时 30 天的日志数据的可见性。
- 如果您希望获取更长存储时间或希望对日志进行个性化分析统计，您可以使用腾讯云上的日志服务（CLS）。虚拟机部署业务接入 CLS 请参见 [CLS 入门指南](https://cloud.tencent.com/document/product/614/34340)。容器部署业务接入 CLS 请参见 [TKE 日志采集](https://cloud.tencent.com/document/product/457/36771)。
- 更多日志服务 CLS 产品能力请参见文档 [日志服务产品概述](https://cloud.tencent.com/document/product/614/11254)。
>!日志迁移到 CLS 中，您可以使用 CLS 中更丰富的日志分析能力，但 TSF 中提供的日志与调用链联动能力无法继续使用。


