## 功能简介
规则引擎旨在通过丰富的规则语言，支持按需自定义处理特定类型请求的配置规则。在规则引擎创建的自定义策略将覆盖边缘服务器的默认行为。

## 适用场景
- 站点加速处的站点级配置无法覆盖全部业务情况，不同子域名，路径或文件后缀等不同条件下有差异化配置，需针对特定请求自定义功能配置。
- 当前业务除了需要缓存，HTTPS 等基础配置，还需要自定义 Cache Key， URL 重写和修改 HTTP 头部等其他加速功能

## 操作步骤
1. 登录 [边缘安全加速平台控制台](https://console.tencentcloud.com/edgeone) ，在左侧菜单栏中，单击**规则引擎**。
2. 在规则引擎页面，选择所需站点，单击**添加规则**。
3. 在添加规则窗口中，配置相关参数，需提交规则：
   - 仅保存：仅保存规则内容，不下发配置至现网生效。
   - 保存并发布：保存并下发规则内容至现网生效。

## 关键术语

| 定义       | 说明                                                         |
| ---------- | ------------------------------------------------------------ |
| 规则       | 规则包含特定类型的请求以及应用于它们的一系列操作。 包括：<li>一组条件表达式，用于定义识别请求的逻辑。</li><li>一组匹配条件，定义用于识别请求的标准。</li><li>定义CDN 将如何处理上述请求的一组功能。</li> |
| 条件表达式 | 用于定义识别请求的逻辑，支持以下类别：<li>IF <br/>注：IF 语句可以嵌套在一层 IF 语句下，即执行内嵌 IF 语句之前必须先满足最外层 IF 语句。</li><li>ELSE IF </li><li> ELSE |
| 匹配条件   | 用于定义识别请求的标准，包括：</li><li>匹配类型 </li><li> 运算符 </li><li>值</li> |
| And/Or     | 逻辑与/逻辑或，可连接多个匹配条件。                            |
| 操作       | 命中的请求执行的一系列功能配置。                               |

## 优先级

| 范围                                      | 说明                                                         |
| ----------------------------------------- | ------------------------------------------------------------ |
| 规则引擎 vs 站点加速                      | 规则引擎优先级更高，是最终生效的配置。                         |
| 规则引擎单条规则中 | 受相对顺序影响，从上至下执行，下方优先级更高，是最终生效的配置。|
| 规则引擎中的多条规则 | 受相对顺序影响，从上至下执行，下方优先级更高，是最终生效的配置。<br>提示：确定规则放置位置时，可将具有通用性或粗粒度的规则放在上方位置作为默认配置，针对特定请求或细粒度的规则放在下方位置。|

### 注意事项

部分操作不受相对顺序的影响，具体说明如下：

- Token 鉴权
  [Token 鉴权](https://cloud.tencent.com/document/product/1552/71007) 不管出现在哪个位置，永远是最先执行的。例如，现有请求同时命中了2条规则，Token 鉴权操作在下方的规则中，则 Token 鉴权会最先执行，鉴权通过才继续执行剩下的内容。
