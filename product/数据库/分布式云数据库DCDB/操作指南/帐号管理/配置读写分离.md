
## 基于只读帐号的读写分离
1. 登录 [TDSQL 控制台](https://console.cloud.tencent.com/tdsqld/instance-tdmysql)，在**实例列表**，单击实例 ID 或**操作**列的**管理**，进入实例管理页面。
2. 在实例管理页面，选择**帐号管理**页，单击**创建帐号**。
3. 在弹出的对话框，设置帐号信息，**创建为只读帐号**设置为**是**，单击**确认，下一步**。
4. 在弹出的对话框，选择**只读请求分配策略**，定义在备机故障（或延迟较大）时的读策略，及设置**只读备机延迟参数**，单击**确定**。
 - 选择**主机**则全部备机延迟时，从主机读取。
 - 选择**直接报错**则全部备机延迟时，直接报错。
 - 选择**只从备机读取**则忽略备机延迟，一直从备机读取（一般用于拉取 binlog 同步）。
 - **只读备机延迟参数**定义数据同步延迟时间。
<table>
<thead><tr><th>分配策略</th><th>只读固定备机</th><th>不只读固定备机</th></tr></thead>
<tbody><tr>
<td>主机</td>
<td>延迟后，若大于延迟参数，则切换到主机读取</td>
<td>延迟后，若大于延迟参数，则先读其他备机，其他备机延迟后切换到主机读取</td></tr>
<tr>
<td>直接报错</td>
<td>延迟后，若大于延迟参数，则直接报错</td>
<td>延迟后，若大于延迟参数，则先读其他备机，其他备机延迟后直接报错</td></tr>
<tr>
<td>只从备机读取</td>
<td>延迟后，只读固定备机</td>
<td>-</td></tr>
</tbody></table>
>?若需要修改只读帐号设置，可以在帐号列表，在**操作**列选择**更多** > **修改只读分配策略**。
>
<img src="https://qcloudimg.tencent-cloud.cn/raw/a24c30d76634b8ef8686f3faeb0dd8cb.png"  style="zoom:90%;">

## 基于注释的读写分离
在每条需要从机“读”的 SQL 前，增加 `/*slave*/`  字段，并且 mysql 后面增加 -c 参数来解析注释 `mysql -c -e "/*slave*/sql"`，即可自动将“读”请求分配到从机，代码示例如下：
```
//主机读//
select * from emp order by sal，deptno desc；
//从机读//
/*slave*/ select * from emp order by sal，deptno desc；
```
>!
>- 该功能仅支持从机读（select），不支持其他操作，非 select 语句将失败。
>- mysql 后面要增加 -c 参数来解析注释。
>-  `/*slave*/` 必须为小写，语句前后无空格。
>- 从机出现异常而影响到 MAR（强同步）机制时，从机读操作将自动切换回主机。
